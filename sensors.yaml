
- platform: yr
  name: Weather
  forecast: 1
  monitored_conditions:
    - temperature
    - symbol
    - precipitation
    - windSpeed
    - pressure
    - windDirection
    - humidity
    - fog
    - cloudiness
    - lowClouds
    - mediumClouds
    - highClouds
    - dewpointTemperature
- platform: moon
- platform: systemmonitor
  resources:
    - type: disk_use_percent
      arg: /home
    - type: memory_free
    - type: processor_use
    - type: since_last_boot
- platform: command_line
  name: SSL cert expiry
  unit_of_measurement: days
  scan_interval: 10800
  command: "ssl-cert-check -b -c /etc/letsencrypt/live/has.nizmo.eu/cert.pem | awk '{ print $NF }'"
- platform: travisci
  api_key: !secret travisapi
  scan_interval: 3600
  repository: Home-AssistantConfig
  branch: master
  monitored_conditions: 
    - last_build_state
    - last_build_id
    - last_build_duration
    - state
- platform: template
  sensors:
    battery_status:
      friendly_name: "Battery Status"
      entity_id:
      - input_boolean.battery_status_update
      value_template: >
        {%- set threshold = 40 -%}
        {%- set domains = ['light', 'switch', 'sensor', 'zwave', 'lock'] -%}
        {%- for domain in domains -%}
        {%- for item in states[domain] if ((item.attributes.battery_level is defined and item.attributes['battery_level'] | int < threshold) or ("battery" in item.name | lower and ((item.state | int < threshold and item.state|int != 0) or item.state | lower == "low" or item.state | lower == "unknown"))) -%}
        {%- if (item.attributes.battery_level is defined and item.attributes['battery_level'] | int < threshold) -%}
        {{ item.name }} ({{ item.attributes['battery_level'] }}){%- if not loop.last %}, {% endif -%}{% endif -%}
        {%- if "battery" in item.name | lower and ((item.state | int < threshold and item.state|int != 0) or item.state | lower == "low" or item.state | lower == "unknown") -%}
        {{ item.name }} ({{ item.state }}){%- if not loop.last %}, {% endif -%} {% endif -%}
        {%- endfor -%}
        {%- endfor -%}
#  - platform: airvisual
#    api_key: !secret airvisual_api_key
#    monitored_conditions:
#      - us
#      - cn
#    latitude: !secret home_latitude
#    longitude: !secret home_longitude
#    radius: 500
#    show_on_map: true

- platform: mqtt
  state_topic: "owntracks/Tablet1/tablet"
  name: "Battery Tablet"
  unit_of_measurement: "%"
  value_template: '{{ value_json.batt }}'
- platform: mqtt
  state_topic: "owntracks/Nizm0/phone"
  name: "My Phone Battery"
  unit_of_measurement: "%"
  value_template: '{{ value_json.batt }}'